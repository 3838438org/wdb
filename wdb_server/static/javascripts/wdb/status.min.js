/*! wdb           2014-04-17 */

(function(){var a,b,c,d,e,f,g,h,i,j;a=function(){function a(){this.debug=$("body").attr("data-debug")||!1}return a.prototype.log=function(){var a,b;return this.debug?(b="["+this.constructor.name+"]",a=[b].concat(Array.prototype.slice.call(arguments,0)),console.log.apply(console,a)):void 0},a.prototype.fail=function(){var a,b;return b=this.constructor.name,a=[b].concat(Array.prototype.slice.call(arguments,0)),console.error.apply(console,a)},a}(),i=null,h=25,d=function(a,b){var c;return(c=$(".sessions tr[data-uuid="+a+"]")).size()||(c=$('<tr data-uuid="'+a+'"> <td class="uuid"><a href="/debug/session/'+a+'">'+a+'</a></td> <td class="socket">No</td> <td class="websocket">No</td> <td class="close"><a href="/uuid/'+a+'/close">Force close</a></td>'),$(".sessions tbody").append(c)),c.find("."+b).text("Yes")},g=function(a,b){var c;if((c=$(".sessions tr[data-uuid="+a+"]")).size())return"socket"===b&&"No"===c.find(".websocket").text()||"websocket"===b&&"No"===c.find(".socket").text()?c.remove():c.find("."+b).text("No")},c=function(a){var b,c,d,e,f,g;for(b=JSON.parse(a),d="<tr>",g=["fn","lno","cond","fun"],e=0,f=g.length;f>e;e++)c=g[e],d+='<td class="'+c+'">'+(b[c]||"∅")+"</td>";return d+='<td class="action"> <a href="/debug/file/'+b.fn+'" class="icon-open">Open</a> <a href="" class="icon-remove">Remove</a> </td>',d+="</tr>",$(".breakpoints tbody").append($(d))},f=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(c=JSON.parse(a),k=$(".breakpoints tr"),m=[],g=0,i=k.length;i>g;g++){for(f=k[g],b=$(f),e=!0,l=["fn","lno","cond","fun"],h=0,j=l.length;j>h;h++)d=l[h],e=e&&b.find("."+d).text()===""+(c[d]||"∅");m.push(e?b.remove():void 0)}return m},j=function(a){var b,e,i,j;switch(h=25,i=a.data,j=i.indexOf("|"),j>-1?(b=i.substr(0,j),e=i.substr(j+1)):(b=i,e=""),b){case"AddWebSocket":return d(e,"websocket");case"AddSocket":return d(e,"socket");case"RemoveWebSocket":return g(e,"websocket");case"RemoveSocket":return g(e,"socket");case"AddBreak":return c(e);case"RemoveBreak":return f(e)}},b=function(){return i=new WebSocket("ws://"+location.host+"/status"),i.onopen=function(){return console.log("WebSocket open",arguments),$("tbody tr").remove(),i.send("ListSockets"),i.send("ListWebSockets"),i.send("ListBreaks")},i.onerror=function(){return console.log("WebSocket error",arguments)},i.onmessage=j,i.onclose=function(){return console.log("WebSocket closed",arguments),h*=2,setTimeout(b,h)}},e=function(a){return"∅"===a?null:a},$(function(){return b(),$(".open-self").click(function(){return $.get("/self"),!1}),$(".breakpoints tbody").on("click",".icon-remove",function(){var a,b;return a=$(this).closest("tr"),b={fn:a.find(".fn").text(),lno:parseInt(a.find(".lno").text()),cond:e(a.find(".cond").text()),fun:e(a.find(".fun").text())},i.send("RemoveBreak|"+JSON.stringify(b)),!1})})}).call(this);
//# sourceMappingURL=status.min.map