/*! wdb           2014-04-17 */

(function(){var a,b,c,d,e,f,g,h,i,j,k;a=function(){function a(){this.debug=$("body").attr("data-debug")||!1}return a.prototype.log=function(){var a,b;return this.debug?(b="["+this.constructor.name+"]",a=[b].concat(Array.prototype.slice.call(arguments,0)),console.log.apply(console,a)):void 0},a.prototype.fail=function(){var a,b;return b=this.constructor.name,a=[b].concat(Array.prototype.slice.call(arguments,0)),console.error.apply(console,a)},a}(),j=null,i=25,e=function(a,b){var c;return(c=$(".sessions tr[data-uuid="+a+"]")).size()||(c=$('<tr data-uuid="'+a+'"> <td class="uuid"><a href="/debug/session/'+a+'">'+a+'</a></td> <td class="socket">No</td> <td class="websocket">No</td> <td class="close"><a class="fa fa-times-circle" href="/uuid/'+a+'/close">Force close</a></td>'),$(".sessions tbody").append(c)),c.find("."+b).text("Yes")},h=function(a,b){var c;if((c=$(".sessions tr[data-uuid="+a+"]")).size())return"socket"===b&&"No"===c.find(".websocket").text()||"websocket"===b&&"No"===c.find(".socket").text()?c.remove():c.find("."+b).text("No")},c=function(a){var b,c,d,e,f,g;for(b=JSON.parse(a),d="<tr>",g=["fn","lno","cond","fun"],e=0,f=g.length;f>e;e++)c=g[e],d+='<td class="'+c+'">'+(b[c]||"∅")+"</td>";return d+='<td class="action"> <a href="/debug/file/'+b.fn+'" class="fa fa-folder-open">Open</a> <a href="" class="fa fa-minus-circle">Remove</a> </td>',d+="</tr>",$(".breakpoints tbody").append($(d))},g=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(c=JSON.parse(a),k=$(".breakpoints tr"),m=[],g=0,i=k.length;i>g;g++){for(f=k[g],b=$(f),e=!0,l=["fn","lno","cond","fun"],h=0,j=l.length;j>h;h++)d=l[h],e=e&&b.find("."+d).text()===""+(c[d]||"∅");m.push(e?b.remove():void 0)}return m},d=function(a){var b,c,d,e,f,g,h;for(d=JSON.parse(a),c="<tr>",h=["pid","user","cmd","time","threads","mem","cpu"],f=0,g=h.length;g>f;f++)b=h[f],e=d[b],null==e&&(e="∅"),"time"===b?(e=(new Date).getTime()/1e3-e,e=Math.round(e)+" s"):("mem"===b||"cpu"===b)&&(e=e.toFixed(2)+"%"),c+='<td class="'+b+'">'+e+"</td>";return c+='<td class="action"> <a href="" class="icon-inspect">Remove</a> </td>',c+="</tr>",$(".processes tbody").append($(c))},k=function(a){var b,f,j,k;switch(i=25,j=a.data,k=j.indexOf("|"),k>-1?(b=j.substr(0,k),f=j.substr(k+1)):(b=j,f=""),b){case"AddWebSocket":return e(f,"websocket");case"AddSocket":return e(f,"socket");case"RemoveWebSocket":return h(f,"websocket");case"RemoveSocket":return h(f,"socket");case"AddBreak":return c(f);case"RemoveBreak":return g(f);case"Process":return d(f)}},b=function(){return j=new WebSocket("ws://"+location.host+"/status"),j.onopen=function(){return console.log("WebSocket open",arguments),$("tbody tr").remove(),j.send("ListSockets"),j.send("ListWebSockets"),j.send("ListBreaks"),j.send("ListProcesses")},j.onerror=function(){return console.log("WebSocket error",arguments)},j.onmessage=k,j.onclose=function(){return console.log("WebSocket closed",arguments),i*=2,setTimeout(b,i)}},f=function(a){return"∅"===a?null:a},$(function(){return b(),$(".open-self").click(function(){return $.get("/self"),!1}),$(".breakpoints tbody").on("click",".icon-remove",function(){var a,b;return a=$(this).closest("tr"),b={fn:a.find(".fn").text(),lno:parseInt(a.find(".lno").text()),cond:f(a.find(".cond").text()),fun:f(a.find(".fun").text())},j.send("RemoveBreak|"+JSON.stringify(b)),!1})})}).call(this);
//# sourceMappingURL=status.min.map